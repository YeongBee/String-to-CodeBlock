<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>인라인 스타일 코드 변환기 (No Library Needed)</title>
    <!-- 1. Highlight.js 로드 (변환 과정에서만 사용됨) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- 2. 테마별 CSS를 로드하지만, 이를 계산해서 인라인으로 박아넣음 -->
    <link id="theme-link" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/vs2015.min.css">
    
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
        .container { display: flex; gap: 20px; height: 600px; }
        .box { flex: 1; display: flex; flex-direction: column; background: white; border-radius: 8px; padding: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        textarea { width: 100%; height: 100%; border: 1px solid #ddd; font-family: monospace; padding: 10px; resize: none; }
        
        .controls { margin-bottom: 15px; background: white; padding: 15px; border-radius: 8px; display: flex; gap: 10px; align-items: center; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold; }
        button:hover { background: #0056b3; }
        
        /* 숨겨진 영역 (스타일 계산용) */
        #hidden-area { position: absolute; left: -9999px; top: -9999px; visibility: hidden; }
    </style>
</head>
<body>

    <h1>블로그용 인라인 스타일 변환기</h1>
    <p>외부 CSS나 JS가 없는 블로그 게시판에서도 색상이 유지되도록, 모든 스타일을 태그 안에 직접 넣습니다.</p>

    <div class="controls">
        <select id="lang-select">
            <option value="java">Java</option>
            <option value="python">Python</option>
            <option value="javascript">JavaScript</option>
            <option value="sql">SQL</option>
            <option value="json">JSON</option>
            <option value="html">HTML</option>
            <option value="css">CSS</option>
            <option value="bash">Bash</option>
        </select>
        
        <!-- 테마 선택 시 실제로 CSS 파일을 교체해서 색상을 추출함 -->
        <select id="theme-select" onchange="changeTheme()">
            <option value="vs2015">VS 2015 (Dark)</option>
            <option value="github">GitHub (Light)</option>
            <option value="monokai">Monokai (Dark)</option>
            <option value="default">Default (Light)</option>
            <option value="atom-one-dark">Atom One Dark</option>
        </select>

        <button onclick="convertInline()">변환 및 복사 (Convert)</button>
    </div>

    <div class="container">
        <div class="box">
            <h3>1. 코드 입력</h3>
            <textarea id="input-code" placeholder="코드를 여기에 넣으세요..."></textarea>
        </div>
        <div class="box">
            <h3>2. 결과 HTML (자동 복사됨)</h3>
            <textarea id="output-html" readonly placeholder="변환 버튼을 누르면 인라인 스타일이 적용된 HTML이 나옵니다."></textarea>
        </div>
    </div>

    <!-- 스타일 계산을 위한 숨겨진 컨테이너 -->
    <div id="hidden-area">
        <pre><code id="temp-code"></code></pre>
    </div>

    <script>
        function changeTheme() {
            const theme = document.getElementById('theme-select').value;
            document.getElementById('theme-link').href = `https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/${theme}.min.css`;
        }

        function convertInline() {
            const input = document.getElementById('input-code').value;
            const lang = document.getElementById('lang-select').value;
            const tempCode = document.getElementById('temp-code');
            const hiddenArea = document.getElementById('hidden-area');

            // 1. 숨겨진 영역에 코드 넣고 하이라이팅 실행
            tempCode.textContent = input;
            tempCode.className = `language-${lang}`;
            tempCode.removeAttribute('data-highlighted');
            hljs.highlightElement(tempCode);

            // 2. computedStyle을 사용하여 실제 색상을 추출해 인라인 스타일로 변환
            // 배경색과 글자색 가져오기 (pre, code 태그)
            const preStyle = window.getComputedStyle(hiddenArea.querySelector('pre'));
            const codeStyle = window.getComputedStyle(tempCode);
            
            const bgColor = codeStyle.backgroundColor !== 'rgba(0, 0, 0, 0)' ? codeStyle.backgroundColor : '#1e1e1e'; // 기본값 보호
            const textColor = codeStyle.color;

            // 모든 span 태그를 순회하며 색상을 인라인으로 박기
            const spans = tempCode.querySelectorAll('span');
            spans.forEach(span => {
                const style = window.getComputedStyle(span);
                span.style.color = style.color;
                span.style.fontWeight = style.fontWeight;
                span.style.fontStyle = style.fontStyle;
                // 불필요한 클래스 제거 (블로그 용량 절약)
                span.removeAttribute('class');
            });

            // 3. 최종 HTML 조립
            // pre 태그에 배경색, 패딩, 폰트 등을 강제로 지정
            const finalHtml = `<div style="background-color: ${bgColor}; color: ${textColor}; padding: 15px; border-radius: 5px; overflow-x: auto; font-family: Consolas, 'Courier New', monospace; font-size: 14px; line-height: 1.5;">
<pre style="margin: 0;">${tempCode.innerHTML}</pre>
</div>`;

            // 4. 결과 출력 및 복사
            const outputArea = document.getElementById('output-html');
            outputArea.value = finalHtml;
            
            outputArea.select();
            try {
                navigator.clipboard.writeText(finalHtml).then(() => {
                    alert("변환 완료! 클립보드에 복사되었습니다. 블로그 HTML 편집기에 붙여넣으세요.");
                });
            } catch (err) {
                document.execCommand('copy');
                alert("변환 완료! (구형 방식 복사)");
            }
        }
        
        // 초기 예제
        window.onload = function() {
            document.getElementById('input-code').value = 'public class Test {\n    public static void main(String[] args) {\n        System.out.println("Hello World");\n    }\n}';
        }
    </script>
</body>
</html>

