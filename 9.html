<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì½”ë“œ ë³€í™˜ê¸° (ì¤„ê°„ê²©/JSON ìˆ˜ì •íŒ)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link id="theme-link" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/vs2015.min.css">
    
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: #f4f4f9; max-width: 1200px; margin: 0 auto; color: #333; }
        
        .controls { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); display: flex; gap: 15px; flex-wrap: wrap; align-items: flex-end; }
        .control-group { display: flex; flex-direction: column; gap: 5px; }
        label { font-size: 12px; font-weight: bold; color: #666; }
        select, input { padding: 10px; border-radius: 6px; border: 1px solid #ddd; font-size: 14px; outline: none; height: 42px; box-sizing: border-box; }
        button { padding: 0 25px; border-radius: 6px; border: none; font-weight: bold; cursor: pointer; color: white; height: 42px; font-size: 14px; }
        #btn-convert { background: #007bff; }
        #btn-copy { background: #28a745; }
        
        .container { display: flex; gap: 20px; height: 500px; margin-bottom: 40px; }
        .box { flex: 1; display: flex; flex-direction: column; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .box-header { padding: 12px 15px; background: #f8f9fa; font-weight: bold; color: #555; border-bottom: 1px solid #eee; }
        textarea { width: 100%; height: 100%; border: none; padding: 15px; resize: none; font-family: 'Consolas', monospace; font-size: 13px; outline: none; box-sizing: border-box; }
        
        #hidden-area { position: absolute; top: -9999px; visibility: hidden; }

        /* ë¯¸ë¦¬ë³´ê¸° ì„¹ì…˜ ìŠ¤íƒ€ì¼ ìƒëµ (ì´ì „ê³¼ ë™ì¼) */
        .theme-preview-section { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .theme-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .theme-card { border: 1px solid #eee; border-radius: 8px; overflow: hidden; cursor: pointer; text-align: center; padding: 10px; font-size: 14px; font-weight: bold; color: #555; background: #f9f9f9; }
        .theme-card:hover { background: #eef; border-color: #aaf; }
    </style>
</head>
<body>

    <h1 style="text-align: center;">Easy Code Block Generator</h1>
    
    <div class="controls">
        <div class="control-group">
            <label>ì–¸ì–´</label>
            <select id="lang-select">
                <option value="java">Java</option>
                <option value="python">Python</option>
                <option value="javascript">JavaScript</option>
                <option value="json">JSON</option>
                <option value="sql">SQL</option>
                <option value="html">HTML</option>
                <option value="css">CSS</option>
                <option value="bash">Bash</option>
                <option value="yaml">YAML</option>
            </select>
        </div>
        <div class="control-group">
            <label>í…Œë§ˆ</label>
            <select id="theme-select" onchange="changeTheme()">
                <option value="vs2015">VS 2015 (Dark)</option>
                <option value="github">GitHub (Light)</option>
                <option value="monokai">Monokai (Dark)</option>
                <option value="atom-one-dark">Atom One Dark</option>
                <option value="dracula">Dracula</option>
                <option value="default">Default</option>
            </select>
        </div>
        <div class="control-group">
            <label>ì œëª©</label>
            <input type="text" id="title-input" placeholder="ì˜ˆ: data.json">
        </div>
        <div class="control-group">
            <label>í°íŠ¸ (px)</label>
            <input type="number" id="font-size-input" value="14" min="10" max="30">
        </div>
        <button id="btn-convert" onclick="convertCode()">ë³€í™˜í•˜ê¸°</button>
        <button id="btn-copy" onclick="copyResult()">ê²°ê³¼ ë³µì‚¬</button>
    </div>

    <div class="container">
        <div class="box">
            <div class="box-header">1. ì†ŒìŠ¤ ì½”ë“œ ì…ë ¥</div>
            <textarea id="input-code" placeholder="ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
        </div>
        <div class="box">
            <div class="box-header">2. ë³€í™˜ëœ HTML ê²°ê³¼</div>
            <textarea id="output-html" readonly placeholder="ë³€í™˜ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìƒì„±ë©ë‹ˆë‹¤."></textarea>
        </div>
    </div>

    <!-- í…Œë§ˆ ë¯¸ë¦¬ë³´ê¸° (ê°„ì†Œí™”) -->
    <div class="theme-preview-section">
        <h3>ğŸ¨ í…Œë§ˆ ë¹ ë¥¸ ì„ íƒ</h3>
        <div class="theme-grid">
            <div class="theme-card" onclick="selectTheme('vs2015')">VS 2015 (Dark)</div>
            <div class="theme-card" onclick="selectTheme('github')">GitHub (Light)</div>
            <div class="theme-card" onclick="selectTheme('monokai')">Monokai (Dark)</div>
            <div class="theme-card" onclick="selectTheme('atom-one-dark')">Atom One Dark</div>
            <div class="theme-card" onclick="selectTheme('dracula')">Dracula</div>
            <div class="theme-card" onclick="selectTheme('default')">Default</div>
        </div>
    </div>

    <div id="hidden-area">
        <pre><code id="temp-code"></code></pre>
    </div>

    <script>
        function changeTheme() {
            const theme = document.getElementById('theme-select').value;
            document.getElementById('theme-link').href = `https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/${theme}.min.css`;
        }
        
        function selectTheme(themeName) {
            document.getElementById('theme-select').value = themeName;
            changeTheme();
        }

        function convertCode() {
            const input = document.getElementById('input-code').value;
            if (!input.trim()) { alert("ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }

            const lang = document.getElementById('lang-select').value;
            const title = document.getElementById('title-input').value.trim();
            const fontSize = document.getElementById('font-size-input').value;
            const tempCode = document.getElementById('temp-code');
            const hiddenArea = document.getElementById('hidden-area');

            // 1. í•˜ì´ë¼ì´íŒ… ì‹¤í–‰
            tempCode.textContent = input;
            tempCode.className = `language-${lang}`;
            tempCode.removeAttribute('data-highlighted');
            hljs.highlightElement(tempCode);

            // 2. ìŠ¤íƒ€ì¼ ì¶”ì¶œ
            const codeStyle = window.getComputedStyle(tempCode);
            let bgColor = codeStyle.backgroundColor;
            let textColor = codeStyle.color;

            // [ìˆ˜ì •] JSON/ë°°ê²½ìƒ‰ ì‹œì¸ì„± ë³´ì • ë¡œì§
            // ë°°ê²½ì´ ë„ˆë¬´ ì–´ë‘¡ê±°ë‚˜(íˆ¬ëª… í¬í•¨) JSONì¼ ë•Œ ê°€ë…ì„± í™•ë³´
            if (bgColor === 'rgba(0, 0, 0, 0)' || bgColor === 'transparent' || (lang === 'json' && bgColor === 'rgb(0, 0, 0)')) {
                bgColor = '#1e1e1e'; // ì™„ì „ ê²€ì • ëŒ€ì‹  ë¶€ë“œëŸ¬ìš´ ë‹¤í¬ ê·¸ë ˆì´ ì‚¬ìš©
            }
            
            // ê¸€ììƒ‰ì´ ë„ˆë¬´ ì–´ë‘ìš°ë©´ ë°ê²Œ ì¡°ì • (JSON ë“±ì—ì„œ ë°œìƒ)
            const rgb = textColor.match(/\d+/g);
            if (rgb) {
                const brightness = (parseInt(rgb[0]) * 299 + parseInt(rgb[1]) * 587 + parseInt(rgb[2]) * 114) / 1000;
                if (brightness < 50 && bgColor === '#1e1e1e') { 
                    textColor = '#d4d4d4'; // ë°°ê²½ì´ ì–´ë‘ìš´ë° ê¸€ìë„ ì–´ë‘ìš°ë©´ ë°ì€ íšŒìƒ‰ìœ¼ë¡œ ê°•ì œ
                }
            }

            // 3. ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ ì ìš© (JSON Key/Value ìƒ‰ìƒ ë³´ì • í¬í•¨)
            tempCode.querySelectorAll('span').forEach(span => {
                const style = window.getComputedStyle(span);
                let color = style.color;
                
                // [ìˆ˜ì •] JSON Key(ì†ì„±ëª…) ìƒ‰ìƒ ê°•ì œ ë³´ì • (ì˜ ì•ˆë³´ì´ëŠ” ê²½ìš°)
                if (lang === 'json') {
                    if (span.classList.contains('hljs-attr')) {
                        color = '#9cdcfe'; // ë°ì€ í•˜ëŠ˜ìƒ‰ (VS Code ìŠ¤íƒ€ì¼)
                    } else if (span.classList.contains('hljs-string')) {
                        color = '#ce9178'; // ì‚´êµ¬ìƒ‰ (VS Code ìŠ¤íƒ€ì¼)
                    } else if (span.classList.contains('hljs-number') || span.classList.contains('hljs-literal')) {
                        color = '#b5cea8'; // ì—°ë‘ìƒ‰
                    }
                }
                
                span.style.color = color;
                span.style.fontWeight = style.fontWeight;
                span.removeAttribute('class');
            });

            // 4. ì¤„ ë²ˆí˜¸ ìƒì„± (ë†’ì´ 1.5ë°° ê³ ì •)
            // [ì¤‘ìš”] ì¤„ ê°„ê²©(line-height)ì„ 1.5emìœ¼ë¡œ ê³ ì •í•˜ì—¬ ì–‘ìª½ ë†’ì´ë¥¼ ì •í™•íˆ ë§ì¶¤
            const lines = input.split(/\r\n|\r|\n/);
            let lineNumbersHtml = '';
            for (let i = 1; i <= lines.length; i++) {
                // padding-top/bottom ì—†ì´ ë†’ì´ë§Œ 1.5emìœ¼ë¡œ ì£¼ì–´ ì˜¤ì°¨ ì œê±°
                lineNumbersHtml += `<div style="height: 1.5em; line-height: 1.5em;">${i}</div>`;
            }

            // 5. ì œëª© í—¤ë”
            let headerHtml = '';
            if (title) {
                const titleSize = Math.max(12, fontSize - 1);
                headerHtml = `<div style="background-color: rgba(255, 255, 255, 0.05); padding: 8px 15px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); font-family: sans-serif; font-size: ${titleSize}px; font-weight: bold; color: ${textColor}; opacity: 0.9;">${title}</div>`;
            }

            // 6. ìµœì¢… HTML ì¡°ë¦½
            // [ì¤‘ìš”] font-familyì™€ line-heightë¥¼ ë¶€ëª¨ ë ˆë²¨ì—ì„œ í•œ ë²ˆë§Œ ì •ì˜í•˜ì—¬ ìƒì†ë°›ê²Œ í•¨ -> ì˜¤ì°¨ ì›ì¸ ì œê±°
            const finalHtml = `<!-- ì½”ë“œ ë¸”ë¡ ì‹œì‘ -->
<div style="background-color: ${bgColor}; color: ${textColor}; border-radius: 8px; overflow: hidden; margin: 20px 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); font-family: Consolas, 'Courier New', monospace; font-size: ${fontSize}px; line-height: 1.5em;">
${headerHtml}
<div style="display: flex; align-items: flex-start; padding: 12px 0;">
    <!-- ì¤„ ë²ˆí˜¸ ì˜ì—­ -->
    <div style="
        user-select: none; -webkit-user-select: none; 
        text-align: right; 
        padding: 0 10px 0 15px; 
        margin-right: 10px; 
        border-right: 1px solid rgba(128, 128, 128, 0.3); 
        color: rgba(255, 255, 255, 0.4); 
        min-width: 30px; 
        font-family: inherit; 
        line-height: inherit; /* ë¶€ëª¨ line-height ìƒì† */
    ">
        ${lineNumbersHtml}
    </div>
    
    <!-- ì½”ë“œ ì˜ì—­ -->
    <div style="flex: 1; overflow-x: auto; padding-right: 12px;">
        <pre style="margin: 0; font-family: inherit; line-height: inherit; white-space: pre;">${tempCode.innerHTML}</pre>
    </div>
</div>
</div>
<!-- ì½”ë“œ ë¸”ë¡ ë -->`;

            document.getElementById('output-html').value = finalHtml.trim();
        }

        function copyResult() {
            const outputText = document.getElementById('output-html');
            if (!outputText.value) { alert("ë¨¼ì € [ë³€í™˜í•˜ê¸°]ë¥¼ ì§„í–‰í•´ì£¼ì„¸ìš”."); return; }
            outputText.select();
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(outputText.value).then(() => alert('HTML ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!')).catch(err => alert('ë³µì‚¬ ì‹¤íŒ¨: ' + err));
            } else {
                document.execCommand('copy');
                alert('HTML ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }
        }
        
        window.onload = function() {
            // ì´ˆê¸° ì˜ˆì œ: JSON
            document.getElementById('lang-select').value = 'json';
            document.getElementById('input-code').value = '{\n    "name": "JSON Test",\n    "isActive": true,\n    "count": 42,\n    "items": ["A", "B", "C"]\n}';
        }
    </script>
</body>
</html>
